TEST: How to Verify Visualization Fix
=====================================

BEFORE (Broken):
When you asked Tera: "i want you to create the actual 'animated 3D globe' visual for me"
Tera returned: A Mermaid flowchart diagram (error message)

AFTER (Fixed):
When you ask Tera: "i want you to create the actual 'animated 3D globe' visual for me"
Tera should return: Complete HTML with Three.js code that renders an interactive 3D globe

---

TEST CASES TO TRY:
==================

Test 1: 3D Globe Request
------------------------
Ask Tera: "Create an animated 3D globe with Three.js. The globe should rotate and have continent colors."

Expected Response: 
- Complete HTML document
- <!DOCTYPE html> tag
- <script src="three.js..."></script>
- JavaScript code using THREE.Scene, THREE.SphereGeometry, etc.
- Auto-rotating sphere
- Should render as an interactive 3D visualization

Test 2: Canvas Animation
-----------------------
Ask Tera: "Generate a canvas particle system animation with 100 moving particles"

Expected Response:
- Complete HTML document
- Canvas element creation
- Canvas drawing code with ctx.fillStyle, ctx.fillRect, etc.
- requestAnimationFrame loop
- Should show animated particles

Test 3: SVG Visualization
-------------------------
Ask Tera: "Create an animated SVG with rotating circles"

Expected Response:
- SVG code with proper namespace
- Animated SVG elements
- CSS animations or JS animations
- Should render as scalable graphics

Test 4: Data Visualization
--------------------------
Ask Tera: "Create an interactive bar chart with D3.js showing quarterly sales"

Expected Response:
- Complete HTML with D3.js library
- D3 code for creating chart
- Data binding and scale functions
- Should render as interactive chart

---

HOW TO TEST:
=============

1. Go to chat page (/new)
2. Ask one of the test questions above
3. Look for:
   ✅ Complete HTML code block
   ✅ Interactive visualization below the code
   ✅ No error messages about "Failed to render diagram"
   ✅ Smooth animations (if requested)
   ✅ Responsive to window resize

If you see:
❌ "Failed to render diagram" message
❌ Mermaid flowchart instead of 3D/animation
❌ Syntax error about "graph TD"

That means the fix didn't work or Tera didn't return HTML code.

---

WHAT CHANGED:
==============

File: components/PromptShell.tsx
- Reordered detection priority
- HTML/Three.js/Canvas now checked FIRST before Mermaid
- Added isHTML() and isVisualization() detector functions
- Mermaid only used if explicitly marked as ````mermaid

Result:
- 3D globe requests now render as 3D visualization
- Canvas animations render as animations
- No more false Mermaid diagram detection

---

KEY PROMPT KEYWORDS THAT NOW WORK:
===================================

When asking for visuals, use phrases like:
- "Create/Build/Generate an animated/interactive [thing]"
- "Make a 3D [object] using Three.js"
- "Build a particle system/animation"
- "Create an SVG [graphic]"
- "Make a data visualization"

These will trigger HTML/visualization code instead of Mermaid.

AVOID phrases like (they might trigger Mermaid):
- "Show me a flowchart/diagram of how..."
- "Create a process flow"
- "Make a mindmap"
- "Draw a UML diagram"
